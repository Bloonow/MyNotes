# 稀疏矩阵存储格式

稀疏矩阵常用的存储格式有COO（coordinate，坐标格式）、CSR（compressed sparse row，压缩稀疏行）、（compressed sparse column，压缩稀疏列）三种。

COO格式是将矩阵中的非零元素以坐标的方式存储，这种存储格式比较简单，每一个非零元素用一个三元组（行号,列号,数值）来表示，即(row_idx,col_idx,val)，如下图所示。

<img src="数据结构与算法.assets/COO.png" style="zoom: 67%;" />

- row_indices：values数组中对应元素的行索引。
- column_indices：values数组中对应元素的列索引。
- values：矩阵中的非零元素的数值。

CSR格式是将矩阵元素按行顺序存储，如下图所示。

<img src="数据结构与算法.assets/CSR.png" style="zoom:67%;" />

- row_offsets：行偏移量。若矩阵有m行，则数组有m+1个元素。数组的idx索引上的元素代表的是矩阵行索引为idx的行的信息，它表示矩阵idx行之前（不含）所有非零元素的个数，最后一个值就可表示矩阵所有非零元素的个数。显然idx+1行的值减去idx行的值，得到的即是idx行非零元素的个数。如果idx行的非零元素个数不为0（即该行有非零元素），则row_offsets[idx]的值就是，该idx行的其他信息在column_indices数组和values数组中的索引（偏移）。如果计算得到idx行的非零元素个数为0（全是零元素），则跳过该行。

- column_indices：对于某一行来说，非零元素的列索引（从左到右）。
- values：矩阵中的非零元素的数值。

CSC格式是将矩阵元素按列顺序存储，如下图所示。

<img src="数据结构与算法.assets/CSC.png" style="zoom:67%;" />

- column_offsets：列偏移量。若矩阵有n列，则数组有n+1个元素。数组的idx索引上的元素代表的是矩阵列索引为idx的列的信息，它表示矩阵idx列之前（不含）所有非零元素的个数，最后一个值就可表示矩阵所有非零元素的个数。显然idx+1列的值减去idx列的值，得到的即是idx列非零元素的个数。如果idx列的非零元素个数不为0（即该列有非零元素），则column_offsets[idx]的值就是，该idx列的其他信息在row_indices数组和values数组中的索引（偏移）。如果计算得到idx列的非零元素个数为0（全是零元素），则跳过该列。
- row_indices：对于某一列来说，非零元素的行索引（从上到下）。
- values：矩阵中的非零元素的数值。

CSC与CSR类似，只不过其存储遍历方向正好一个按行一个按列。

# 带状矩阵及其存储

当稀疏矩阵的非零元素都集中在以主对角线为中心的带状区域时，称为带状矩阵（Band Matrix）。假设一个M行N列的带状矩阵，其上带宽的对角线条数为U，下带宽的对角线条数为L，则其示意图如下所示。

<img src="数据结构与算法.assets/Band Matrix.png" style="zoom:50%;" />

带状矩阵在计算机中的存储时，将一条对角线组织为一行元素，两端不足的位置使用无意义的值进行补齐，如上图所示。可以看到，带状矩阵实际上存储(U+L+1)\*N个元素，并存在一些无效的占位元素，可以按行主序存储或列主序存储。元素的逻辑位置为A[i,j]时，则该元素在内存中的存储到Storage[i-j+U+1,j]位置。